import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
from matplotlib.pyplot import figure
import re

#Import tsv files
data = pd.read_csv("C:/Users/lilak/Documents/Master BMS-O/Research Project 1/Python/mg.kraken.parsed.tsv", sep='\t')

#Keeps from the column D all the values that are not NaN

data = data[data['D'].notna()]

#Keeps the rows of the columns D that contain a specific name
df = data.loc[data['D'].str.contains('Eukaryota')]

# Groups by Species column and sums up all the contigs lenght of each taxon 
df2 = df.groupby(['S'])['length'].sum().sort_values(ascending=False).reset_index()

df2.plot(x ='S', y ='length', kind='barh', figsize=(20,10))
plt.legend(bbox_to_anchor=(1.04, 1), loc="upper left", prop={'size':4}) #places the legend outside of the axes of the plot in the upper left corner
plt.title('Patient 1203 day 14 post HCT Eukaryota  total contig lenghts')
plt.xlabel(' total contig length')
plt.tight_layout()
plt.ylabel('taxa')

plt.savefig('C:/Users/lilak/Documents/Master BMS-O/Research Project 1/Python/Plots/filename.png', dpi=1200)
